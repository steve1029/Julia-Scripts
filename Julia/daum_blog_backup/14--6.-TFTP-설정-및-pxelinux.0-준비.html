
<meta charset="utf-8">
<html lang="ko">
<head>
    <link rel="stylesheet" type="text/css" href="./../style.css" />
    <title> 6. TFTP 설정 및 pxelinux.0 준비</title>
</head>
<body id="tt-body-page" class="">
<div id="wrap" class="wrap-right">
    <div id="container">
        <main class="main ">
            <div class="area-main">
                <div class="area-view">
                    <div class="article-header">
                        <div class="inner-article-header">
                            <div class="box-meta">
                                <h2 class="title-article"> 6. TFTP 설정 및 pxelinux.0 준비</h2>
                                <div class="box-info">
                                    <p class="category">리눅스/데비안 서버 구축</p>
                                    <p class="date">2016-09-25 21:00:40</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="article-view">
                        <div class="contents_style">
                            <p>TFTP를 이용하는 이유는 운영체제없이 서버에서 파일을 전송 받기 위해서이다. </p><p><br></p><p>node 는 하드디스크가 없으므로 부팅이 되려면 os 자체를 네트워크를 통해 받아야 하는데,</p><p><br></p><p>보통 네트워크는 OS 가 담당한다. 그러면 어떻게 네트워크를 통해 OS 를 받는단 말인가?</p><p><br></p><p>그 것이 가능한 프로토콜이 바로 TFTP 방식의 프로토콜이다.</p><p><br></p><p>우린 dhcp 서버와 tftp 서버를 따로 두지 않고, 하나의 마스터노드가 두 역할을 다 수행하도록 만들것이다.<br><br>즉 우리의 마스터노드, 즉 yboot 는 dhcp + tftp 서버이다.<br><br>노드가 서버로부터 전송받을 파일은 pxelinux.0 (네트워크부트로더) 와 커널, 커널 모듈이다.&nbsp;</p><p><br></p><p>즉 지금부터는 서버에서 준비해야하는 작업들을 할 것이다.</p><p><br></p><p>절대 노드의 루트파일 시스템에서 하는 일이 아니다. 클러스터를 효율적으로 관리하기 위해서는</p><p><br></p><p>각 컴퓨터의 역할을 확실히 정하고 나누어 주어야 한다.</p><p><br></p><p>첫번째 단계는 yboot가 slave 노드들에게 줄&nbsp;pxelinux.0 을 준비하는 것이다.</p><p><b><br></b></p><p><span style="font-size: 14pt;"><b><span style="color: rgb(255, 187, 0);">yboot 서버에서 다음을 실행하자.</span></b></span></p><p><br></p><p style="margin-left: 2em;"># aptitude install -y syslinux pxelinux tftpd-hpa tftp-hpa</p><p style="margin-left: 2em;"><br></p><p style="margin-left: 2em;"># cp /usr/lib/PXELINUX/pxelinux.0 /tftpboot<br><br>	# cp /usr/lib/syslinux/modules/bios/ldlinux.c32 /tftpboot/</p><p style="margin-left: 2em;"><br></p><p>그리고 pxelinux 설정파일을 만들어야 한다.</p><p><br></p><p style="margin-left: 2em;"># vi /tftpboot/config.pxelinux.y101</p><p style="margin-left: 2em;"><br></p><p>여기에 다음과 같이 입력한다.&nbsp;</p><p><br></p><p style="margin-left: 2em;">default node<br>	label node<br><br>		kernel vmlinuz.cpunode<br>		append root=/dev/nfs initrd.img.cpunode nfsroot=192.168.100.1:/nfsroot/cpunode ip=dhcp rw vga=0x318</p><p>이렇게 모든 노드에 대해 config.pxelinux.y* 파일을 만들어 준다.</p><p><br></p><p>그 다음, tftp로 연결했을 때 서버의 어떤 폴더에 접근할 수 있는지 설정해줘야한다.</p><p><br></p><p style="margin-left: 2em;"># vi /etc/default/tftpd-hpa</p><p style="margin-left: 2em;"><br></p><p>여기에서 다음의 항목을 찾아 아래와 같이 수정해준다.</p><p><br></p><p style="margin-left: 2em;">TFTP_DIRECTORY="/tftpboot"<br>	TFTP_OPTIONS="--listen --secure"</p><p><br></p><p>다른 부분은 건드리지 않는다.</p><p><br></p><p>이는 클라이언트가 tftp로 서버에 접속했을시 서버의 /tftpboot 폴더 안에 있는 내용에만<br><br>접근이 가능하다는 뜻이다. 즉 노드는 서버의 /tftpboot 폴더에만 접근 가능하다.</p><p><br></p><p>그리고 여기 있는 부트로더(pxelinux.0)와 커널, 커널 모듈 등등을 읽을 수 있게 된다.<br><br>이외 서버의 다른 폴더에는 허가가 나지 않았으므로 클라이언트(노드)가 접속 할 수 없다.</p><p><br></p><p>노드가 서버의 보안과 안정성을 해치지 않도록 하기 위함이다.<br><br>설정이 끝났으므로 새로운 설정을 적용하기 위해 tftp를 재실행한다.</p><p><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;"># /etc/init.d/tftpd-hpa restart</span><br></p><p><br>그 다음 tftp가 제대로 작동하는지 서버 컴퓨터 내부에서 /tftpboot내의 특정 파일을</p><p><br></p><p>다른 디렉토리로 전송을 해봄으로서&nbsp;test해본다.</p><p><br></p><p>test 방법은&nbsp;<span style="font-size: 9pt;">매뉴얼에 나와 있다. 매뉴얼의 내용을 옮겨 왔다.</span></p><p><br></p><hr style="border-width: 1px 0px 0px; border-style: solid none none; border-color: black; border-image: none; height: 1px; display: block;"><p><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">TFTP</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">는</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">내부적인</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">파일</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">전송을</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">통해</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">간단히</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">테스트해</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">볼</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">수</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">있다</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">. </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">단</span><span style="line-height: 107%; font-family: &quot;Times New Roman&quot;, serif; font-size: 10pt;"><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">UDP</span></span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">를</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">사용하면</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">원본</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">파일의</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">유무나</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">전송의</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">성공</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">/</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">실패</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">여부에</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">상관없이</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">항상</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">파일이</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">생성되므로</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">반드시</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">파일</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">크기가</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">원본과</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">동일한지</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">확인해야</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">한다</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">. </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">만약</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">파일크기가</span><span style="line-height: 107%; font-family: &quot;Times New Roman&quot;, serif; font-size: 10pt;"><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">0</span></span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">으로</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">표시되면</span><span style="line-height: 107%; font-family: &quot;Times New Roman&quot;, serif; font-size: 10pt;"><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">tftp </span></span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">전송이</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">실패한</span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">것이다</span><span style="line-height: 107%; font-family: &quot;Times New Roman&quot;, serif; font-size: 10pt;"><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">.</span><a name="_ftnref1" title="" href="file:///E:/Clouds/Google%20Drive/%EC%97%B0%EA%B5%AC%EC%8B%A4%20%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%B6%95%20%EC%9E%90%EB%A3%8C/%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B4%80%EB%A0%A8/Diskless%20CPU_GPU%20heterogeneous%20cluster%20on%20Debian.docx#_ftn1"><span class="MsoFootnoteReference"><span class="MsoFootnoteReference" style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">[1]</span></span></a></span></p><div><span style="line-height: 107%; font-family: &quot;Times New Roman&quot;,serif; font-size: 10pt; mso-fareast-font-family: 바탕; mso-ansi-language: EN-US; mso-fareast-language: KO; mso-bidi-language: AR-SA;"><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"><br></span></span></div>/tftpboot# ls -lh pxelinux.0<br><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
-rwxr-xr-x 1 root root 17K 2009-11-03 16:29 pxelinux.0</span><br><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">/tftpboot# cd /tmp</span><br><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
/root# tftp 192.168.100.1</span><a name="_ftnref2" title="" href="file:///E:/Clouds/Google%20Drive/%EC%97%B0%EA%B5%AC%EC%8B%A4%20%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%B6%95%20%EC%9E%90%EB%A3%8C/%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B4%80%EB%A0%A8/Diskless%20CPU_GPU%20heterogeneous%20cluster%20on%20Debian.docx#_ftn2"><span class="MsoFootnoteReference"><!--[if !supportFootnotes]--><span class="MsoFootnoteReference" style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">[2]</span><!--[endif]--></span></a><br><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
tftp&gt; get pxelinux.0</span><br><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
tftp&gt; quit</span><br><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
/root# ls –lh</span><br><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
-rwxr-xr-x 1 root root 17K 2009-11-03 16:29 pxelinux.0 </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">

</span><div><!--[if !supportFootnotes]--><br clear="all"><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">

</span><hr width="33%" size="1" align="left"><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">

</span><!--[endif]--><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">

</span><div id="ftn1"><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">

</span><p class="MsoFootnoteText"><a name="_ftn1" title="" href="file:///E:/Clouds/Google%20Drive/%EC%97%B0%EA%B5%AC%EC%8B%A4%20%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%B6%95%20%EC%9E%90%EB%A3%8C/%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B4%80%EB%A0%A8/Diskless%20CPU_GPU%20heterogeneous%20cluster%20on%20Debian.docx#_ftnref1"><span class="MsoFootnoteReference"><span><!--[if !supportFootnotes]--><span class="MsoFootnoteReference"><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">[1]</span></span><!--[endif]--></span></span></a><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">보통</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">파일</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">전송이</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">실패하여</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">TFTP </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">테스트가</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">제대로</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">되지</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">않을</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">경우</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">, </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">대부분의</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">원인은</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">TFTP </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">설정이</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">잘못되었거나</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">내부</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">네트워크</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">설정이</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">잘못된</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">것이다</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">. TFTP </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">설정</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">및</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">내부</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">네트워크</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">설정이</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">제대로</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">되어</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">있는지</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">확인해보고</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">, </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">필요에</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">따라</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">2.1 </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">절에서</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">설명된</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">대로</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">다시</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">설정해</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">보도록</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">하자</span><span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">. </span></span></p><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">

</span></div><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">

</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">

</span></div><p><a name="_ftn2" title="" style="font-size: 9pt;" href="file:///E:/Clouds/Google%20Drive/%EC%97%B0%EA%B5%AC%EC%8B%A4%20%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%B6%95%20%EC%9E%90%EB%A3%8C/%EB%A6%AC%EB%88%85%EC%8A%A4%20%EA%B4%80%EB%A0%A8/Diskless%20CPU_GPU%20heterogeneous%20cluster%20on%20Debian.docx#_ftnref2"><span class="MsoFootnoteReference"><span><span class="MsoFootnoteReference"><span style="color: rgb(0, 216, 255); line-height: 107%; font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">[2]</span></span></span></span></a><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> TFTP </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">서버의</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> IP </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">주소</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">, </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">본</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">문서에서는</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">TFTP </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">서버가</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">루트</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">서버와</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">동일하므로</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">루트</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">서버의</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">내부</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">네트워크</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">
</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">IP</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">를</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">입력하면</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;"> </span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">된다</span><span style="color: rgb(0, 216, 255); font-family: Dotum, 돋움, sans-serif; font-size: 9pt;">.</span><br></p><p><br></p><hr style="border-width: 1px 0px 0px; border-style: solid none none; border-color: black; border-image: none; height: 1px; display: block;"><p><span style="font-size: 9pt;">매뉴얼의 방법은 풀어쓰면 다음과 같다.'</span></p><p>	<br>	# mkdir /tftpboot/tmp<br><br>이제 이 tmp 폴더로 /tftpboot안의 pxelinux.0 를 tftp로&nbsp;불러오는 것이다.<br>	<br>즉 /tftpboot/pxelinux.0 을 /tftpboot/tmp/pxelinux.0 으로 가져오는것.</p><p><br></p><p>이 때 tftp는 기존 파일을 잘라내기로 가져오는 것이 아니고&nbsp; 복사해서 가져온다. 파일이 생기면 <br><br>	# ls -lh<br><br>명령을 통해서 용량을 꼭 확인하도록 한다.</p><div style="background: url(&quot;//i1.daumcdn.net/deco/contents/horizontalrule/line05.gif?v=2&quot;) repeat-x left; width: 99%; height: 15px;"><hr style="border: 0px black; border-image: none; left: -9999px; top: -9999px; position: relative;"></div><p>그 다음 과정은 initramfs 를 만드는 작업이다. 먼저 커널 버전을 확인하자.</p><p><br></p><p># uname -r</p><p>3.16.0-4-amd64</p><p><br></p><p>#cp /boot/vmlinuz-3.16.0-4-amd64 /tftpboot/vmlinuz.y205</p><p><br>매뉴얼 대로 하면 되지만 주의할 점이 있다.<br><br>우리가 TFTP를 이용하는 이유는 부트 모듈을 네트워크로 불러오기 위함이다.</p><p><br></p><p>네트워크 부팅의 기본 개념은 매우 간단하다.</p><p><br></p><p>리눅스가 정상 설치된 하드디스크에서, 리눅스의 커널만 빼서 네트워크로 slave node에게&nbsp;넘겨주는 것이다.<br><br>서버에 설치된 리눅스의 커널 이미지는 /boot 안에 들어 있으며</p><p><br></p><p>그 모듈의 이름을 바꿔서 tftpboot에 복사, 저장해야한다. 커널 모듈은 /etc/initramfs-tools 에 들어있다.</p><p><br></p><p>이것또한 폴더 째로 복사해서 tftpboot 폴더에 저장해야하는데, 이번에도 폴더의 이름을 바꿔서 저장한다.</p><p><br></p><p>커널 이미지는 ramfs, 즉 램 파일 시스템이다. ramfs 는 하드디스크가 아닌&nbsp;램 위에 저장되는 파일 형식으로, </p><p><br></p><p>네트워크를 통해 전송되면&nbsp;노드의 램 위에 자동으로 올라감과 동시에&nbsp;<span style="font-size: 9pt;">압축이 풀리면서 제 역할을 한다.</span></p><p><span style="font-size: 9pt;"><br></span></p><p><span style="font-size: 9pt;">그리고 전원이 꺼지면 '당연히' 사라진다.</span></p><p><br>하지만 커널 모듈은, 노드에서의 작동 방식이 커널 이미지와는&nbsp;다르다.</p><p><br></p><p>네트워크 부팅을 통해 작동하도록 따로 설정&nbsp;해줘야한다. 이는 initramfs.conf 파일을 수정하면 된다.</p><p><br></p><p>매뉴얼은 오래 되어서 현재 설정 파일과 내용이 약간 다르다. 없으면 추가하면 된다.<br><br>initrd 이미지를 형성할 때 오류가 나면 uname -r 부분을 바꿔주자. 무엇으로 바꿔야할지는<br><br># uname -r 을 쳐보면 안다. 이는 서버의 리눅스 커널의 버전을 알려주는 명령어이다.<br><br>그리고 mission firmware 오류가 난다면, 이것은 상용 랜드라이버가 깔려있지 않아서 나타나는<br><br>오류이다. 최신 드라이버를 깔아서 네트워크 드라이버의&nbsp;커널을 바꿔주어야한다. <br><br>내 테스트 서버는 인터넷에 연결된 랜카드가 realtek 사 제품이므로, <br><br>	# aptitude install realtek-firmware<br><br>라고 하거나 정확한 명칭을 모르면 aptitude 에서 realtek 을 검색한다.<br><br>깔아주는 방법은 aptitude 이지만, aptitude에도 없을 수가 있다.</p><p><br></p><p>이 때는 /etc/apt/sources.list 에 들어가서 us ftp 사이트 뒤에 non-free contrib 를 추가해주면,</p><p><br></p><p>영리 목적 소프트웨어들도 깔 수 있게 된다.<br><br>또한 /etc/default/tftpd-hpa 에서 tftp의 설정을 변경할 수 있다.&nbsp;</p><p><br></p><p>즉 tftp 로 어느 폴더의 내용물을 불러올&nbsp;수 있게 하는지 설정해 줄 수 있는 파일이다.</p><p><br></p><p>TFTP_DIRECTORY 를 /tftpboot 라고 설정해주면,</p><p><br></p><p>tftp로 접속할 때 /tftpboot 의 내용물을 다른 곳으로 전송할 수 있게 된다.<br><br>TFTP의 설정파일을 건드려줬을 때는 항상 /etc/init.d/tftpd-hpa restart 를 해줘야 한다.&nbsp;</p><p><br></p><p>어느 설정파일을&nbsp;건드리던 꼭 해줘야 한다. 그래야 바뀐 설정이 적용이 된다.</p><div style="background: url(&quot;//i1.daumcdn.net/deco/contents/horizontalrule/line05.gif?v=2&quot;) repeat-x left; width: 99%; height: 15px;"><hr style="border: 0px black; border-image: none; left: -9999px; top: -9999px; position: relative;"></div><p>위 과정을 모든 모드 마다 해주어야 하기 때문에, 모든 과정을 하나의 스크립트로 처리했다.<br></p><p><br></p><p># python prepare.kernel.and.module.py</p><p><br></p><p>이 파일을 실행했는데 다음과 같은 에러가 뜬다면 firmware 문제이다.</p><p><br></p><p>Possible missing firmware /lib/firmware/rtl_nic/rtl8168e-1.fw for module r8169<br></p><p><br></p><p>랜카드가 realtek 사 제품이기 때문에 다음 앱을 설치해주자.</p><p><br></p><p># aptitude install -y firmware-realtek</p><p><br></p><p>참고로 이 패키지는 non-free 로 분류되기 때문에 /etc/apt/sources.list 를 수정하지 않았다면</p><p><br></p><p>aptitude 에서 검색되지 않아 설치할 수 없다.</p><p><br></p><p>설치 과정에서 로그를 살펴보면&nbsp;initramfs 를 수정하는 것을 볼 수 있다.</p><p><br></p><p>만약 명수형이 만든 코드로 하고 싶다면, 다음의 순서대로 스크립트를 실행하자.</p><p><br></p><p># mkdir /tftpboot/initramfs-pxe.node</p><p># python make.initramfs.directory.py</p><p># python make.initramfs.conf.py</p><p># python make.config.pxelinux.py</p><p><br></p><p><br></p><p>18.10.20 일자로 한방에 할 수 있는 스크립트를 만들었다.</p><p># python3 /tftpboot/prepare.cpu.kernel.and.module.py</p><p><br></p><p>주의할 점은, 노드의 커널과 커널 모듈이 서버와 버전이 달라질 수 있으므로,</p><p>서버의 커널/커널모듈을 /tftpboot 폴더로 복사하는 작업은 수동으로 해줘야한다.</p><p><br></p><p># cp -a /boot/vimlinuz-&lt;version&gt; /tftpboot/vmlinuz-&lt;version&gt;.cpunode</p><p># cp -a /etc/initramfs-tools /tftpboot/initramfs-tools-&lt;version&gt;.cpunode</p><div style="background: url(&quot;//i1.daumcdn.net/deco/contents/horizontalrule/line06.gif?v=2&quot;) repeat-x left; width: 99%; height: 15px;"><hr style="border: 0px black; border-image: none; left: -9999px; top: -9999px; position: relative;"></div><p>이쯤에서 노드의 네트워크 부팅 과정을 정리 해보자.</p><p><br></p><p>1. DHCP 서버를 찾는다.</p><p>2. DHCP 서버로부터 IP 획득</p><p>3. DHCP 서버로부터 pxelinux.0 파일, pxe 설정 파일의 위치를 알아냄.</p><p>4. TFTP 서버를 통해 pxelinux.0 와 ldlinux.c32 파일을 받는다.</p><p>5. 네트워크 부팅이 이루어지며 pxe 설정 파일에 적힌 vmlinuz 와 initrd 파일을&nbsp;TFTP 서버를 통해 전송받음.<br></p><p>6. pxe 설정 파일에 적힌 root directory 경로를 자신의 / 에 마운트 함.<br></p>
                        </div>
                        <br/>
                        <div class="tags">
                            
                        </div>
                    </div>
                    
                </div>
            </div>
        </main>
    </div>
</div>
</body>
</html>
