
<meta charset="utf-8">
<html lang="ko">
<head>
    <link rel="stylesheet" type="text/css" href="./../style.css" />
    <title>cuda 윈도우 설치법</title>
</head>
<body id="tt-body-page" class="">
<div id="wrap" class="wrap-right">
    <div id="container">
        <main class="main ">
            <div class="area-main">
                <div class="area-view">
                    <div class="article-header">
                        <div class="inner-article-header">
                            <div class="box-meta">
                                <h2 class="title-article">cuda 윈도우 설치법</h2>
                                <div class="box-info">
                                    <p class="category">컴퓨터 언어/CUDA</p>
                                    <p class="date">2016-09-25 18:38:41</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="article-view">
                        <div class="contents_style">
                            <p>이 문서는 2016년 06월 24일 저녁 8시부터 작성하기 시작한 것으로</p><p><br></p><p>내가 처음으로 KAIST 서울캠퍼스에서 MPI와 CUDA 기초를 배우고 난 후 작성한 것이다.</p><p><br></p><p>Nvidia사의 공식 홈페이지 Developer guide를 보고 공부한 것을 정리한 노트이다.</p><p><br></p><p>이 당시 toolkit의 버전은 7.5 였다.</p><p><br></p><p><br></p><p><br></p><p>1.</p><p style="margin-left: 4em;"><span style="font-size: 9pt;">윈도우에서 CUDA 프로세서를 돌리기 위해선 먼저 다음 프로그램들을 다운 받아서 설치해야 한다.</span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;">1. Visual Studio 2013</span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;"></span><br></p><p style="margin-left: 6em;"><span style="font-size: 9pt;"># 반드시 이걸 먼저 설치한 후 toolkit을 설치해야한다. toolkit이 설치과정에서 VS 의 설정을 바꾼다.</span></p><p style="margin-left: 6em;"><span style="font-size: 9pt;"># 2015 버전은 toolkit에서 지원하지 않음. Sample 파일을 빌딩할 수 없으니 반드시 2013버전으로 설치한다. </span><span class="Apple-tab-span" style="font-size: 9pt; white-space: pre;">		</span></p><p><br></p><p style="margin-left: 4em;">2. NVidia CUDA toolkit</p><p style="margin-left: 4em;"><br></p><p style="margin-left: 4em;"><span style="font-size: 9pt;">3. Visual C++ 2013</span><span class="Apple-tab-span" style="font-size: 9pt; white-space: pre;">		</span></p><p style="margin-left: 6em;"><span style="font-size: 9pt;"># 매년 새 버전이 나오는 것 같다.</span><br></p><p><br></p><p style="margin-left: 4em;">각각 공식 홈페이지에서 다운 받도록 하자.</p><p><br></p><p><br></p><p><br></p><p>2.</p><p><span class="Apple-tab-span" style="white-space: pre;">	</span>윈도우 명령 프롬프트 창에서 다음을 입력하면 장치관리자가 바로 뜬다.</p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">	</span>control /name Microsoft.DeviceManager</p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">	</span>여기서 자신의 그래픽 카드를 확인할 수 있다.</p><p><br></p><p><br></p><p><br></p><p>3.</p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">	</span>toolkit 을 기본 경로로 설치하면 다음의 디렉토리가 새로 생긴다.</p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">	</span></p><p><span class="Apple-tab-span" style="white-space: pre;">		</span>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v7.5</p><p><br></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">	</span>이 폴더 내의 내용물은 다음과 같다.</p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">		</span>/Bin<span class="Apple-tab-span" style="white-space: pre;">			</span># 컴파일러 실행 파일과 run time libraries.</p><p><span class="Apple-tab-span" style="white-space: pre;">	</span></p><p><span class="Apple-tab-span" style="white-space: pre;">		</span>/Include<span class="Apple-tab-span" style="white-space: pre;">		</span># CUDA 프로그램을 컴파일 하기 위한 헤더 파일</p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">		</span>/Lib<span class="Apple-tab-span" style="white-space: pre;">			</span># 라이브러리 파일</p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">		</span>/Doc<span class="Apple-tab-span" style="white-space: pre;">			</span># CUDA C 프로그래밍 가이드, 연습 가이드, 라이브러리 설명서, 그 외 설명서</p><p><br></p><p style="margin-left: 12em;"><span class="Apple-tab-span" style="white-space: pre;">	</span>또한 다음 경로에는 sample 파일들이 있다.</p><p style="margin-left: 12em;"><br></p><p style="margin-left: 12em;"><br></p><p style="margin-left: 2em;">C:\ProgramData\NVIDIA Corporation\CUDA Samples\v7.5</p><p style="margin-left: 2em;"><br></p><p style="margin-left: 2em;">여기서 ProgramData 는 숨김파일이므로 탐색기 옵션에서 숨김파일 표시 부분을 체크한 뒤 보자.<span class="Apple-tab-span" style="white-space: pre;">	</span></p><p><br></p><p><br></p><p>4.</p><p><span class="Apple-tab-span" style="white-space: pre;">	</span>Nvidia 의 그래픽 드라이버는 두 종류가 있다.</p><p><br></p><p style="margin-left: 4em;">WDDM : 일반 게임 그래픽 카드 드라이버. 디스플레이 용으로 사용되는 device를 위한 driver다.</p><p style="margin-left: 2em;"><br></p><p style="margin-left: 4em;">TCC : (Tesla compute Cluster) 디스플레이용이 아닌 계산용 GPU를 구동하기 위한 driver.</p><p style="margin-left: 4em;"><br></p><p style="margin-left: 4em;">TCC는 WDDM에 비해 장점이 몇가지 있는데, 그 내용은 다음과 같다.</p><p><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;">(1)&nbsp;WDDM은 윈도우의 TDR 기능 때문에 잠깐 정지되고 reset 되는데, TCC는 그런 일이 없다.</span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 6em;"><span style="font-size: 9pt;"></span>- TDR 이란 timeout detection and recovery의 약자로, </p><p><br></p><p style="margin-left: 6em;">게임 등을 할 때 디스플레이가 무응답 상태가 되어 <span style="font-size: 9pt;">화면이 검게 변하고 </span></p><p style="margin-left: 6em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 6em;"><span style="font-size: 9pt;">컴퓨터가 응답이 없는 것처럼 보이는 현상이다.</span></p><p style="margin-left: 6em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 6em;"><span style="font-size: 9pt;">gpu에 너무 많은 부하가 걸려 화면을 갱신하지 못하는 것</span><span style="font-size: 9pt;">인데,</span><br></p><p><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 6em;"><span style="font-size: 9pt;">TDR은 이런 현상을 미리 감지하고 gpu를 reset 시켜서 다시 화면이 나타나도록 하는 기능이다. 즉 재부팅 안해도 된다!</span><br></p><p><br></p><p style="margin-left: 6em;"><span style="font-size: 9pt;">윈도우 비스타 이후 버전에서는 gpu가 2초이상 응답이 없을 경우, timeout으로 간주하고 해당 gpu 작업을 취소한 다음 reset 한다.</span><br></p><p><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;">(2)&nbsp;WDDM은 Windows Remote Desktop 환경에서 사용할 수 없다. 하지만 TCC는 가능하다.</span></p><p style="margin-left: 6em;"><span style="font-size: 9pt;">즉 윈도우 서버에 GPU 노드를 구성하려면 이걸 이용해야한다.</span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;">(3) 프로세스가 Window services 로 동작 중일 때도 CUDA를 사용할 수 있다.</span></p><p style="margin-left: 6em;"><span style="font-size: 9pt;">WDDM에서는 불가능하다. 무슨 소리인지 모르겠다.</span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;">(4)&nbsp;CUDA 커널이 실행될 때 latency를 줄여준다.</span></p><p style="margin-left: 4em;"><br></p><p style="margin-left: 4em;"><span style="font-size: 9pt;">지포스 GPU는 TCC를 지원하지 않는다.</span></p><p><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;">Device는 TCC로 작동될 때는 WDDM으로 작동될 수 없다. vice versa.</span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 4em;"><span style="font-size: 9pt;">현재 동작 중인 TCC의 버전을 확인하거나 driver 모드를 바꾸려면 nvidia-smi tool을 이용하면 된다.</span></p><p><br></p><p>5.&nbsp;</p><p><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">Toolkit을 설치했으면 이것이 잘 작동하는지 확인해야한다. example 을 돌려보자.</span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">다음 경로로 이동한다.</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">		</span>C:\ProgramData\NVIDIA Corporation\CUDA Samples\v7.5\1_Utilities\deviceQuery</p><p><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">여기서 cpp 파일은 source 이며 .sln 은 solution 파일이다.</span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">솔루션 파일은 프로젝트의 상위 개념으로, 솔루션 안에 여러개의 프로젝트가 있다.</span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">솔루션을 빌드하면 그 안의 모든 프로젝트가 빌드 된다. 빌드한다는 것은 컴파일 한다는 뜻과 같다.</span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">컴파일이 완료 됐으면 디버깅 탭에서&nbsp;</span><span style="font-size: 9pt;">'디버깅 하지 않고 시작' 을 클릭하면 결과가 뜬다.</span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">비주얼 스튜디오로 source 파일을 컴파일하면 solution 파일이 생기는 것이다.</span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">이 내용은 start guide 나 installation guide에 없고 sample guide에 나온다.</span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">불친절하게도 써놨네 아주.</span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">하여튼 이는 visual studio 로 열어야 한다. 윈도우로 개발하는 것은 여러모로 복잡하고 귀찮다.</span></p><p style="margin-left: 2em;"><br></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">모든 sample 파일들을 한꺼번에 빌딩하려면 다음의 폴더로 가자</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">		</span>C:\ProgramData\NVIDIA Corporation\CUDA Samples\v7.5</p><p><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">여기서 Samples_vs2013 파일을 비주얼 스튜디오에서 빌딩하면 된다.</span></p><p><br></p><p style="margin-left: 2em;">파일을 빌딩하고 나면 .exe 파일이 다음의 경로에 생성된다.</p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre;">		</span>C:\ProgramData\NVIDIA Corporation\CUDA Samples\v7.5\bin\win64\Release</p><p><span style="font-size: 9pt;"><br></span></p><p style="margin-left: 2em;"><span style="font-size: 9pt;">cmd에서 위 경로로 들어가 .exe 파일을 실행시키면 그 결과를 볼 수 있다.</span></p>
                        </div>
                        <br/>
                        <div class="tags">
                            
                        </div>
                    </div>
                    
                </div>
            </div>
        </main>
    </div>
</div>
</body>
</html>
